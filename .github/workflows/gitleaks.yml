name: gitleaks

on:

  pull_request:

    branches: [ "main" ]

  workflow_dispatch:



jobs:

  gitleaks:

    runs-on: ubuntu-latest

    steps:

      - uses: actions/checkout@v4

        with:

          fetch-depth: 0

      - name: Run Gitleaks

        uses: gitleaks/gitleaks-action@v2

        with:

          args: --redact -v -c .gitleaks.toml --report-format sarif --report-path gitleaks.sarif

      - name: Upload SARIF to Code Scanning

        uses: github/codeql-action/upload-sarif@v3

        with:

          sarif_file: gitleaks.sarif
